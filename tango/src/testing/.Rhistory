b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',header=T, sep=','))
head(b3)
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, col.names=1 sep=','))
sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, col.names=1, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=T, sep=','))
head(b3)
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv'row.names=1, header=T, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv'row.names=1, header=T, sep=','))
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=T, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=T, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=T, sep=','))
plot(b3, type='o')
plot(b3[1,], type='o')
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
head(b3)
plot(b3[1,], b3[2,] type='o')
plot(b3[1,], b3[2,] type='o')
plot(b3[1,], b3[2,], type='o')
b3[2,]
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
plot(b3[1,], b3[2,], type='o')
b1.mean <- sapply(b1[2:,], 2, mean)
b1.mean <- apply(b1[2:,], 2, mean)
b1.mean <- apply(b1[2: ,], 2, mean)
b1.mean <- apply(b1[2:1,], 2, mean)
b3[2:1,]
b3[2:99]
b3[2:99,]
dim(b3)
b1.mean <- apply(b1[2:1,], 2, mean)
b1.mean <- apply(b1[2:83,], 2, mean)
b1.var <- apply(b1[2:83,], 2, var)
b1.mean <- apply(b1[2:83,], 2, mean)
b1.var <- apply(b1[2:83,], 2, var)
b2.mean <- apply(b2[2:11,],2,mean)
b2.var <- apply(b2[2:11,], 2, var)
b3.mean <- apply(b3[2:14,], 2, mean)
b3.var <- apply(b3[2:14,], 2, var)
plot(b1[1,], b1.mean, type='o')
line(b2[1,], b2.mean, type='o')
lines(b2[1,], b2.mean, type='o')
max(b3.mean)
b3.mean
b1.mean <- apply(b1[2:83,], 2, mean(na.rm=T))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
max(b3.mean)
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)))
lines(b2[1,], b2.mean, type='o')
plot(b3[1,], b3.mean, type='o')
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)))
lines(b2[1,], b2.mean, type='o')
lines(b3[1,], b3.mean, type='o')
lines(b2[1,], b2.mean, type='o', col='darkblue')
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
a <- spline(b1[1,], b1.mean)
plot(a)
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2,ann=F)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='o', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='o',col='forestgreen', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 0.02
epsilon <- 10
segments(b1[1,]-epsilon,b1.mean-sd,b1[1,]+epsilon,b1.mean-sd)
segments(b1[1,]-epsilon,b1.mean+sd,b1[1,]+epsilon,b1.mean+sd)
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 10
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 100
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 500
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 400
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 400
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='red')
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='ltgrey')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var,col='gray50')
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var,col='gray50')
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var,col='gray50')
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var,col='gray50')
segments(b2[1,],b2.mean-b2.var,b2[1,],b2.mean+b2.var,col='gray50')
epsilon <- 300
segments(b2[1,]-epsilon,b2.mean-b2.var,b2[1,]+epsilon,b2.mean-b2.var,col='gray50')
segments(b2[1,]-epsilon,b2.mean+b2.var,b2[1,]+epsilon,b2.mean+b2.var,col='gray50')
segments(b3[1,],b3.mean-b3.var,b3[1,],b3.mean+b3.var,col='gray50')
epsilon <- 300
segments(b3[1,]-epsilon,b3.mean-b3.var,b3[1,]+epsilon,b3.mean-b3.var,col='gray50')
segments(b3[1,]-epsilon,b3.mean+b3.var,b3[1,]+epsilon,b3.mean+b3.var,col='gray50')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(100,100,100), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(100,100,100,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(0.5,0.5,0.5,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(247/255,144/255,41/255,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(247/255,144/255,41/255,1), lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2,col=rgb(181/255,207/255,114/255,1))
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2, col=rgb(67/255,105/255,189/255,1))
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b2[1,], b2.mean, type='l', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=2, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1))
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), main="GATC counts in 5kb sliding window")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
box()
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), main="GATC counts in 5kb sliding window", xlab="Genomic position")
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), +
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
,main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1) +
,main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1) +
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
grid()
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),legend.text="B1 mean"
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(1, 0.02, colnames(jdTopEnd[,1:num]), cex=0.5, col=cp, lty=1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(1, 0.02, colnames(jdTopEnd[,1:num]), cex=0.5, col=cp, lty=1)
# SD BARS LOOK LIKE SHIT
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=0.5, col=cp, lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=0.5, col=c(col1, col2, col3), lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
legend(10000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=3,horiz=T)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
legend(8000, 82, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(8000, 82, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(8000, 83, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
install.packages('extrafont')
library(extrafont)
font_import()
fonts()
# repeat some of the analysis on the data with reverse complements added
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
#tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
tudrc <- as.data.frame(read.table('~/projects/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d<- dist(tudrc)
plot(hist(d))
#holy shit it looks even better this way.
clusters <- sapply(rownames(tudrc), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
cf <- factor(clusters)
tudrc["cluster"] <- clusters
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d<- dist(tudrc)
plot(hist(d))
#holy shit it looks even better this way.
clusters <- sapply(rownames(tudrc), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
cf <- factor(clusters)
tudrc["cluster"] <- clusters
tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
dev4 <- as.data.frame(read.table('~/GitHub/tango/data/kmer_counts/all_dev_k4.tsv'))
dev4 ==tudrc
dev4[1,]
tudrc[1,]
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
dev4 <- as.data.frame(read.table('~/GitHub/tango/data/without_reverse_complement/kmer_counts/all_dev_k4.tsv'))
tud <- as.data.frame(read.table('~/GitHub/tango/data/without_reverse_complement/all_phages_TUD.tsv'))
sum(tud==dev4)
tud[1,]
sum(tudrc[, "AAAA"]==dev4[,"AAAA"])
sum(tud[, "AAAA"]==dev4[,"AAAA"])
tudrc[1:10,"AAAA"]
dev4[1:10,"AAAA"]
tud[1:10,"AAAA"]
hist(tud[,"GATC"])
hist(tud[,"GATC"],breaks=50)
hist(tudrc[,"GATC"],breaks=50)
dev6 <- as.data.frame(read.table('~/GitHub/tango/data/kmer_counts/all_dev_k6.tsv'))
hist(dev4[,"GATC"])
hist(dev4[,"GATC"], breaks=50)
hist(dev6[,"GGATCC"])
hist(dev6[,"GGATCC"], breaks=50)
highlight <- function(x, value, col.value, col=NA, ...){
hst <- hist(x, ...)
idx <- findInterval(value, hst$breaks)
cols <- rep(col, length(hst$counts))
cols[idx] <- col.value
hist(x, col=cols, ...)
}
highight(dev6[,"GGATCC", 0.1, "red"])
highlight(dev6[,"GGATCC", 0.1, "red"])
highlight(dev6[,"GGATCC"], 0.1, "red"])
highlight(dev6[,"GGATCC"], 0.1, "red")
highlight(dev6[,"GGATCC"], 0.1, "red", breaks=50)
highlight(dev6[,"GGATCC"], c(0.1,1,2), "red", breaks=50)
ggplot(dev6, aes(x="rating"GATC)) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
library(ggplot2)
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
library(ggplot)
install.packages("ggplot2")
library(ggplot2)
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev6[,'GATC'], aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev4[,'GATC'], aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
as.data.frame(dev4[,'GATC'])
head(as.data.frame(dev4[,'GATC']))
ggplot(as.data.frame(dev4[,'GATC']), aes(x=1)) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill="white")
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill="white") +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1 +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col2) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3) +
ggtitle("GATC usage deviation")
col3a=rgb(67/255,105/255,189/255,0.5)
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation")
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GATC']), aes(x=dev4[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Hexanucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GGATCC usage deviation") +xlab('Hexanucleotide usage deviation') + ylab('Number of phage')
clusters <- sapply(rownames(dev4), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
clusters
hist(dev6[clusters=='B3',"GGATCC"], breaks=50)
hist(dev6[clusters!='B3',"GGATCC"], breaks=50)
dev6[dev6[,"GGATCC"]>4,"GGATTCC"]
dev6[,"GGATCC"]>4
dev6[dev6[,"GGATCC"]>4,"GGATTCC"]
dev6[dev6[,"GGATCC"]>4,"GGATCC"]
clusters[dev6[,"GGATCC"]>4]
clusters["Q"]
clusters[clusters=="Q"]
clusters[dev6[,"GGATCC"]>3 & dev6[,"GGATCC"] <4]
col2
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance.tsv', sep='\t', quote=F)
library(ape)
install.packages("ape")
ape
library(ape)
all <- read.table(file='GitHub/tango/data/with_reverse_complement/all_TUD_distance.tsv', sep='\t')
plot(all)
plot(all)
plot(all)
dev.off()
plot(all)
par(mar=c(1,1,1,1))
plot(all)
dev.new(width=10, height=10)
plot(all)
dev.off()
pdf('test_nj.pdf')
plot(all)
pdf('test_nj.pdf', width=20, height=20)
plot(all)
par(mar=c(1,1,1,1))
plot(all)
pdf('test_nj.pdf', width=50, height=50)
par(mar=c(1,1,1,1))
plot(all)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
pdf('test_nj.pdf', width=50, height=50)
par(mar=c(1,1,1,1))
plot(all)
pall <- nj(all)
pall <- nj(,X=)
pall <- nj(all)
pall <- njs(all)
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d_all <- as.matrix(dist(all))
plot(d_all)
dev.off()
plot(d_all)
njall <- nj(d_all)
plot(d_all)
plot(njall)
pdf('test_nj.pdf', width=50, height=50)
plot(njall)
dev.off()
dev.off()
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_num.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance_num.tsv', sep='\t', quote=F)
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_NEW.tsv'))
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_NEW.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance_NEW.tsv', sep='\t', quote=F)
setwd("~/GitHub/tango/src/testing")
A2.tud <- as.matrix(read.table('A2.tud',sep=','))
A2.tud
A2.tud <- as.matrix(read.table('A2.tud',sep=',' row.names=1,col.names=1))
A2.tud <- as.matrix(read.table('A2.tud',sep=',', row.names=1,col.names=1))
A2.tud <- as.matrix(read.table('A2.tud',sep=',', row.names=1,col.names=1))
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T)
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T)
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T)
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T))
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T))
A2.tud
dim(A2.tud)
A2.tud[1:3,1:3]
d <- dist(A2.tud)
dm <- as.matriX(d)
dm <- as.matrix(d)
dm
dm <- as.matrix(dist(A2.tud, method='eucl'))
dm
A2.dm <- as.matrix(dist(A2.tud, method='eucl'))
A4.tud  <- as.matrix(read.table('A.tud',sep=',',header=T))
A4.tud  <- as.matrix(read.table('1.tud',sep=',',header=T))
A4.tud
A4.tud  <- as.matrix(read.table('A4.tud',sep=',',header=T))
A4.dm <- as.matrix(dist(A4.tud, method='eucl'))
A4.tud
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T))
A2.tud
A2.tud
A2.tud <- as.matrix(read.table('A2.tud',sep=',',header=T))
A2.tud
A4.tud  <- as.matrix(read.table('A4.tud',sep=',',header=T))
A4.dm <- as.matrix(dist(A4.tud, method='eucl'))
A4.tud
A4.dist
A4.dm
H60.tud <- as.matrix(read.table('H60.tud',sep=',', header=T))
oldH60.tud <- as.matrix(read.table('../../data/kmer_counts//Hatfull_60_subset/Hatful_60_dev_k4.tsv'))
H60.tud[1:5,1:5]
oldH60.tud[1:5,1:5]
H60.tud['224-E']
H60.tud['224-E',]
H60.tud['Halo-G',]
H60.tud['Halo-G','AAAA']
oldH60.tud['Halo(G)','AAAA']
library(ape)
plot(dist(H60.tud))
nh(dist(H60.tud))
nj(dist(H60.tud))
plot(nh(dist(H60.tud)))
plot(nj(dist(H60.tud)))
plot(nj(dist(oldH60.tud)))
oldH60.tud <- as.matrix(read.table('../../data/with_reverse_complement/Hatful_60_TUD.tsv'))
plot(nj(dist(oldH60.tud)))
par(mfrow=c(1,2))
plot(nj(dist(oldH60.tud)))
plot(nj(dist(H60.tud)))
A2.dm

b1.mean <- apply(b1[2: ,], 2, mean)
b1.mean <- apply(b1[2:1,], 2, mean)
b3[2:1,]
b3[2:99]
b3[2:99,]
dim(b3)
b1.mean <- apply(b1[2:1,], 2, mean)
b1.mean <- apply(b1[2:83,], 2, mean)
b1.var <- apply(b1[2:83,], 2, var)
b1.mean <- apply(b1[2:83,], 2, mean)
b1.var <- apply(b1[2:83,], 2, var)
b2.mean <- apply(b2[2:11,],2,mean)
b2.var <- apply(b2[2:11,], 2, var)
b3.mean <- apply(b3[2:14,], 2, mean)
b3.var <- apply(b3[2:14,], 2, var)
plot(b1[1,], b1.mean, type='o')
line(b2[1,], b2.mean, type='o')
lines(b2[1,], b2.mean, type='o')
max(b3.mean)
b3.mean
b1.mean <- apply(b1[2:83,], 2, mean(na.rm=T))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
max(b3.mean)
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)))
lines(b2[1,], b2.mean, type='o')
plot(b3[1,], b3.mean, type='o')
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)))
lines(b2[1,], b2.mean, type='o')
lines(b3[1,], b3.mean, type='o')
lines(b2[1,], b2.mean, type='o', col='darkblue')
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
a <- spline(b1[1,], b1.mean)
plot(a)
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
b1 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B1.tsv',row.names=1, header=F, sep=','))
b2 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B2.tsv',row.names=1, header=F, sep=','))
b3 <- as.matrix(read.table('GitHub/tango/data/without_reverse_complement/GATC_motif_B3.tsv',row.names=1, header=F, sep=','))
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='o', ylim=c(0, max(b3.mean)), col='red')
lines(b2[1,], b2.mean, type='o', col='darkblue')
lines(b3[1,], b3.mean, type='o',col='forestgreen')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2,ann=F)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='o', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='o',col='forestgreen', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 0.02
epsilon <- 10
segments(b1[1,]-epsilon,b1.mean-sd,b1[1,]+epsilon,b1.mean-sd)
segments(b1[1,]-epsilon,b1.mean+sd,b1[1,]+epsilon,b1.mean+sd)
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 10
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 100
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 500
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
epsilon <- 400
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 400
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var)
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var)
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='red')
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='ltgrey')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var,col='gray50')
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var,col='gray50')
b1.mean <- apply(b1[2:83,], 2, function(x) mean(x,na.rm=T))
b1.var <- apply(b1[2:83,], 2, function(x) var(x,na.rm=T))
b2.mean <- apply(b2[2:11,],2,function(x) mean(x,na.rm=T))
b2.var <- apply(b2[2:11,], 2, function(x) var(x,na.rm=T))
b3.mean <- apply(b3[2:14,], 2, function(x) mean(x,na.rm=T))
b3.var <- apply(b3[2:14,], 2, function(x) var(x,na.rm=T))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
segments(b1[1,],b1.mean-b1.var,b1[1,],b1.mean+b1.var,col='gray50')
epsilon <- 300
segments(b1[1,]-epsilon,b1.mean-b1.var,b1[1,]+epsilon,b1.mean-b1.var,col='gray50')
segments(b1[1,]-epsilon,b1.mean+b1.var,b1[1,]+epsilon,b1.mean+b1.var,col='gray50')
segments(b2[1,],b2.mean-b2.var,b2[1,],b2.mean+b2.var,col='gray50')
epsilon <- 300
segments(b2[1,]-epsilon,b2.mean-b2.var,b2[1,]+epsilon,b2.mean-b2.var,col='gray50')
segments(b2[1,]-epsilon,b2.mean+b2.var,b2[1,]+epsilon,b2.mean+b2.var,col='gray50')
segments(b3[1,],b3.mean-b3.var,b3[1,],b3.mean+b3.var,col='gray50')
epsilon <- 300
segments(b3[1,]-epsilon,b3.mean-b3.var,b3[1,]+epsilon,b3.mean-b3.var,col='gray50')
segments(b3[1,]-epsilon,b3.mean+b3.var,b3[1,]+epsilon,b3.mean+b3.var,col='gray50')
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col='red', lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2)
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(100,100,100), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(100,100,100,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(0.5,0.5,0.5,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(247/255,144/255,41/255,1), lwd=2)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), col=rgb(247/255,144/255,41/255,1), lwd=2)
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2,col=rgb(181/255,207/255,114/255,1))
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l',col='forestgreen', lwd=2, col=rgb(67/255,105/255,189/255,1))
lines(b2[1,], b2.mean, type='l', col='darkblue', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b2[1,], b2.mean, type='l', lwd=2, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=2, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1))
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), main="GATC counts in 5kb sliding window")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
box()
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), main="GATC counts in 5kb sliding window", xlab="Genomic position")
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1), +
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
,main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1) +
,main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1) +
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
grid()
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=rgb(181/255,207/255,114/255,1))
lines(b3[1,], b3.mean, type='l', lwd=3, col=rgb(67/255,105/255,189/255,1))
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),legend.text="B1 mean"
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=rgb(247/255,144/255,41/255,1),legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,legend.text="B1 mean",
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(1, 0.02, colnames(jdTopEnd[,1:num]), cex=0.5, col=cp, lty=1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(1, 0.02, colnames(jdTopEnd[,1:num]), cex=0.5, col=cp, lty=1)
# SD BARS LOOK LIKE SHIT
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=0.5, col=cp, lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=0.5, col=c(col1, col2, col3), lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1)
legend(1, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
legend(10000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1,horiz=T)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=3,horiz=T)
legend(8000, 80, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
legend(8000, 82, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(8000, 82, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
col1=rgb(247/255,144/255,41/255,1)
col2=rgb(181/255,207/255,114/255,1)
col3=rgb(67/255,105/255,189/255,1)
plot(b1[1,], b1.mean, type='l', ylim=c(0, max(b3.mean)+10), lwd=3, col=col1,
main="GATC counts in 5kb sliding window", xlab="Genomic position", ylab="GATC counts")
lines(b2[1,], b2.mean, type='l', lwd=3, col=col2)
lines(b3[1,], b3.mean, type='l', lwd=3, col=col3)
legend(8000, 83, c("B1 mean","B2 mean","B3 mean"), cex=1, col=c(col1, col2, col3), lty=1, lwd=3,horiz=T)
install.packages('extrafont')
library(extrafont)
font_import()
fonts()
# repeat some of the analysis on the data with reverse complements added
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
#tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
tudrc <- as.data.frame(read.table('~/projects/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d<- dist(tudrc)
plot(hist(d))
#holy shit it looks even better this way.
clusters <- sapply(rownames(tudrc), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
cf <- factor(clusters)
tudrc["cluster"] <- clusters
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d<- dist(tudrc)
plot(hist(d))
#holy shit it looks even better this way.
clusters <- sapply(rownames(tudrc), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
cf <- factor(clusters)
tudrc["cluster"] <- clusters
tudrc <- as.data.frame(read.table('~/GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
dev4 <- as.data.frame(read.table('~/GitHub/tango/data/kmer_counts/all_dev_k4.tsv'))
dev4 ==tudrc
dev4[1,]
tudrc[1,]
tud <- as.data.frame(read.table('~/GitHub/tango/data/all_phages_TUD.tsv'))
dev4 <- as.data.frame(read.table('~/GitHub/tango/data/without_reverse_complement/kmer_counts/all_dev_k4.tsv'))
tud <- as.data.frame(read.table('~/GitHub/tango/data/without_reverse_complement/all_phages_TUD.tsv'))
sum(tud==dev4)
tud[1,]
sum(tudrc[, "AAAA"]==dev4[,"AAAA"])
sum(tud[, "AAAA"]==dev4[,"AAAA"])
tudrc[1:10,"AAAA"]
dev4[1:10,"AAAA"]
tud[1:10,"AAAA"]
hist(tud[,"GATC"])
hist(tud[,"GATC"],breaks=50)
hist(tudrc[,"GATC"],breaks=50)
dev6 <- as.data.frame(read.table('~/GitHub/tango/data/kmer_counts/all_dev_k6.tsv'))
hist(dev4[,"GATC"])
hist(dev4[,"GATC"], breaks=50)
hist(dev6[,"GGATCC"])
hist(dev6[,"GGATCC"], breaks=50)
highlight <- function(x, value, col.value, col=NA, ...){
hst <- hist(x, ...)
idx <- findInterval(value, hst$breaks)
cols <- rep(col, length(hst$counts))
cols[idx] <- col.value
hist(x, col=cols, ...)
}
highight(dev6[,"GGATCC", 0.1, "red"])
highlight(dev6[,"GGATCC", 0.1, "red"])
highlight(dev6[,"GGATCC"], 0.1, "red"])
highlight(dev6[,"GGATCC"], 0.1, "red")
highlight(dev6[,"GGATCC"], 0.1, "red", breaks=50)
highlight(dev6[,"GGATCC"], c(0.1,1,2), "red", breaks=50)
ggplot(dev6, aes(x="rating"GATC)) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
library(ggplot2)
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
library(ggplot)
install.packages("ggplot2")
library(ggplot2)
ggplot(dev6, aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev6[,'GATC'], aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(dev4[,'GATC'], aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x="GATC")) + geom_histogram(binwidth=.5, colour="black", fill="white")
as.data.frame(dev4[,'GATC'])
head(as.data.frame(dev4[,'GATC']))
ggplot(as.data.frame(dev4[,'GATC']), aes(x=1)) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.5, colour="black", fill="white")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill="white")
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill="white") +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1 +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col1) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col2) +
ggtitle("GATC usage deviation")
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3) +
ggtitle("GATC usage deviation")
col3a=rgb(67/255,105/255,189/255,0.5)
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation")
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev4[,'GATC']), aes(x=dev4[,'GATC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GATC']), aes(x=dev4[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Tetranucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GATC usage deviation") +xlab('Hexanucleotide usage deviation') + ylab('Number of phage')
ggplot(as.data.frame(dev6[,'GGATCC']), aes(x=dev6[,'GGATCC'])) + geom_histogram(binwidth=.1, colour="black", fill=col3a) +
ggtitle("GGATCC usage deviation") +xlab('Hexanucleotide usage deviation') + ylab('Number of phage')
clusters <- sapply(rownames(dev4), function(i) strsplit(x=strsplit(i,split="\\(")[[1]][2], split='\\)')[[1]][1])
clusters
hist(dev6[clusters=='B3',"GGATCC"], breaks=50)
hist(dev6[clusters!='B3',"GGATCC"], breaks=50)
dev6[dev6[,"GGATCC"]>4,"GGATTCC"]
dev6[,"GGATCC"]>4
dev6[dev6[,"GGATCC"]>4,"GGATTCC"]
dev6[dev6[,"GGATCC"]>4,"GGATCC"]
clusters[dev6[,"GGATCC"]>4]
clusters["Q"]
clusters[clusters=="Q"]
clusters[dev6[,"GGATCC"]>3 & dev6[,"GGATCC"] <4]
col2
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance.tsv', sep='\t', quote=F)
library(ape)
install.packages("ape")
ape
library(ape)
all <- read.table(file='GitHub/tango/data/with_reverse_complement/all_TUD_distance.tsv', sep='\t')
plot(all)
plot(all)
plot(all)
dev.off()
plot(all)
par(mar=c(1,1,1,1))
plot(all)
dev.new(width=10, height=10)
plot(all)
dev.off()
pdf('test_nj.pdf')
plot(all)
pdf('test_nj.pdf', width=20, height=20)
plot(all)
par(mar=c(1,1,1,1))
plot(all)
pdf('test_nj.pdf', width=50, height=50)
par(mar=c(1,1,1,1))
plot(all)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
pdf('test_nj.pdf', width=50, height=50)
par(mar=c(1,1,1,1))
plot(all)
pall <- nj(all)
pall <- nj(,X=)
pall <- nj(all)
pall <- njs(all)
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC.tsv'))
d_all <- as.matrix(dist(all))
plot(d_all)
dev.off()
plot(d_all)
njall <- nj(d_all)
plot(d_all)
plot(njall)
pdf('test_nj.pdf', width=50, height=50)
plot(njall)
dev.off()
dev.off()
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_num.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance_num.tsv', sep='\t', quote=F)
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_NEW.tsv'))
all <- as.matrix(read.table('GitHub/tango/data/with_reverse_complement/all_phages_TUD_4_RC_NEW.tsv'))
d_all <- as.matrix(dist(all))
write.table(d_all, file='GitHub/tango/data/with_reverse_complement/all_TUD_distance_NEW.tsv', sep='\t', quote=F)
setwd("~/GitHub/tango")
phageData <- as.data..frame(read.tabe('kmer_analysis/examples/PhagesDB_Data.txt'))
phageData <- as.data.frame(read.tabe('kmer_analysis/examples/PhagesDB_Data.txt'))
phageData <- as.data.frame(read.table('kmer_analysis/examples/PhagesDB_Data.txt'))
phageData <- as.data.frame(read.table('kmer_analysis/examples/PhagesDB_Data.txt'))
phageData <- as.data.frame(read.table('kmer_analysis/examples/PhagesDB_Data.txt',skip=1))
head(phageData)
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv'))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv'), sep=',')
head(allK4)
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=','))
allK4[1:5,1:5]
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1))
allK4[1:5,1:5]
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1))
# NEW CODE 2014-05-18
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1))
allK4[1:5,1:5]
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4[1:5,25-:256]
allK4[1:5,250:256]
allK4[1:5,250:257]
allK4[1:5,250:256]
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',row.names=1,col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',col.names=1,row.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',col.names=1))
allK4 <- as.matrix(read.table('data/kmer_counts/all_phage/all_freq_k4.csv',sep=',',header=T))
allK4[1:5,1:5]
allK4[1:5,250:256]
windows = as.matrix(read.table(paste(baseName, name, ending, sep=''), header=T))
baseName = 'data/kmer_counts/indiviudal_windows/'
ending = '_500_250_k4.csv'
name='Catdawg-O'
windows = as.matrix(read.table(paste(baseName, name, ending, sep=''), header=T))
head(windwos)
windows[1]
windows = as.matrix(read.table(paste(baseName, name, ending, sep=''), sep=',', header=T))
windows[1:5, 1:5]
allK4p <- allK4 / rowSums(allK4)
dmultinom(x=windows[1,],prob=allK4p['Catdawg-O',])
dmultinom(x=windows[1,],prob=allK4p['Catdawg-O',], log=T)
selfSimilarity <- apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Catdawg-O',], log=T)
selfSimilarity <- apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Catdawg-O',], log=T))
selfSimilarity
plot(1:288, selfSimilarity)
plot(1:288, selfSimilarity, type='o')
identify()
identify(1)
plot(1:288, selfSimilarity, type='o')
identify(1)
identify(1,tolerance=10)
identify(1,tolerance=100)
selfSimilarity
compare4k <- apply(allK4p, 1, function(x) dmultinom(windows['4000:4500',], prob=x, log=T))
hist(compare4k)
max(compare4k)
head(sort(compare4k))
head(sort(compare4k, decreasing=T))
patienceSimilarity <- apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T))
patienceSimilarity <- apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T))
plot(1:288, selfSimilarity, type='o')
lines(patienceSimilarity, col='red', type='o')
plot(1:50, selfSimilarity, type='o')
plot(1:50, selfSimilarity[1:50], type='o')
lines(patienceSimilarity[1:50], col='red', type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Gaia-Singleton',], log=T))[1:50], col='blue',type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Madruga-U',], log=T))[1:50], col='green',type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Nilo-R',], log=T))[1:50], col='orange',type='o')
compare4k <- sort(apply(allK4p, 1, function(x) dmultinom(windows['4000:4500',], prob=x, log=T)), decreasing=T)
head(compare4k, n=15)
plot(1:50, selfSimilarity[1:50], type='o')
lines(patienceSimilarity[1:50], col='red', type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Gaia-Singleton',], log=T))[1:50], col='blue',type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Hawkeye-D2',], log=T))[1:50], col='green',type='o')
lines(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Nilo-R',], log=T))[1:50], col='orange',type='o')
plot(1:288, selfSimilarity)
plot(1:288, selfSimilarity, type='o')
plot(250:288, selfSimilarity[250:288], type='o')
selfSimilarity[250:288]
selfSimilarity[280:288]
patience = as.matrix(read.table(paste(baseName, 'Patience-U', ending, sep=''), sep=',', header=T))
plot(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T))
plot(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T)))
plot(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T)),type='o')
plot(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T))[220:230],type='o')
plot(apply(windows, 1, function(x) dmultinom(x,prob=allK4p['Patience-U',], log=T))[210:240],type='o')
